チーム開発

3dのシューテングゲーム
自キャラ、ステージ、敵を3人で分担して作成することとした。

ステージ内に敵を20体ほど配置、全滅させればクリア
を目標として作成を開始した。

また、銃弾はステージ中で拾って補充する仕様とした。

<Playerについて>

サードパーソン視点(以下TPS)を最初の目標としたが
player自体を作ることはFPSに比べて難しいのでフリーアセットでの
実現が難しかった場合はFPSに切り替えることも視野に入れていた。

アセット：3rd Person Controller + Fly Mode
にてTPSのキャラクターの動き、カメラの動きを持ってきた。
playerアセット：Toon Soldiers WW2 demo
にTPSのキャラクターの動き、カメラの動きをスクリプトをアタッチして
走りやジャンプが可能になった。
しかし、銃を構えたまま動かしたかったのでアニメーションレイヤーを1つ足して
オーバーライドにて上半身のみ銃を構えるようにした。

銃弾を出す挙動についてはplayerの銃の先端付近にShooterオブジェクトを作成、
Shooterスクリプトをアタッチした。
Aim中でなければplayerの向いている方向に弾を撃つようにし、
Aim中であればカメラの中央に向かって撃つようににした。
ここはTPS、しかも肩越しのエイム視点でかつ実弾形式の難しいところであった。
最初はshooterの位置ベクトルとカメラの向いている方向のベクトルを使用して
Instantiateするところで間違えてカメラに向かって弾が飛んでいった...

（販売されているゲームでもややレティクルからずれることに納得した）
FPSのRaycastにエフェクトを付けるパターンが比較的楽だと
やり方を模索していく中で思った。
aim中にplayerが動けないようになっている。
これを修正することはanimatorのaimレイヤーを削除して
baseにaim中の足の動作をブレンドすれば可能だが
アセットのアニメーションではレティクルより上に
銃を傾けてしまうので採用していない。
銃をカメラ中央に常に向けるキャラクターが必要と思われる。


playerのHPと残弾管理のためにMyStatusスクリプトを作成した。
残弾回復アイテムをステージ担当の方に実装してもらったので
取得できるようShellItemスクリプトを作成した。

Shooterで撃った弾でダメージを与えられるようにBulletスクリプトを作成して
弾のプレハブにアタッチした。
BulletはEnemyタグにぶつかった場合敵のHPを-10することにした。
また、その都合からここからenemyを触り始めた。

EnemyControllerにHPを減らす、死亡判定を追加した。
その後、敵の攻撃モーションや攻撃する距離は既にあったので
ゾンビプレハブの腕にカプセルコライダーを、カプセルコライダーに
EnemyHitを追加してplayerに当たったらプレイヤーのHPを減らすようにした。
腕のコライダーは攻撃モーション時のみ有効化したかったが
上手くいかなかったので一回playerに当たったら2秒無効の処理とした。
また、ゾンビが死んだあとにplayerがゾンビの腕に触れるとダメージに
ならないようにゾンビ死亡時に腕のコライダーを無効化している。

殴るしかないゾンビだけでは簡単なので遠隔攻撃する敵を追加したい。
→弓を持ったゴブリンのアセットを発見したので追加した。
ここでEnemyControllerをスーパークラス化しないと
playerの攻撃が当たった時にダメージを与えることがしづらくなった。
アニメーションやnavmeshなどサブクラスに持たせないとエラーになる要素が多かった。

矢に関してはアセットはモーションだけなので銃弾と同じく生成した。
矢の先端がplayerを向くようにしたが矢の向きだけplayerを
追尾し続ける状態を修正できていない、、、



タイトル画面、ステージ及び敵やアイテムの生成、UI、サウンド、
ゾンビの追尾及びアニメーションは共同開発者の2名に作成してもらいました。


参考サイト
・弾丸を撃つ　　https://xr-hub.com/archives/7782
・UnityChanに攻撃モーションを追加　　https://xr-hub.com/archives/7391
	
4/24　追加事項
・マウスカーソルが動いてGame画面から出てしまう対策として弾を撃ったら
　カーソルが中央固定の状態で隠れるようにした（escでカーソル出現)
・着弾時のエフェクトを追加
・発射位置にフラッシュ追加
・Hp0以下で死亡するようにした
・Mystatusスクリプトアタッチを空オブジェクト→Playerとした


4/24 merge後
Gamemanager のGameOverは南保が呼び出す処理をプレイヤーに追加

